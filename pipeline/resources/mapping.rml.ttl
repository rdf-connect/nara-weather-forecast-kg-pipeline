@base <http://example.com/>.
@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix schema: <https://schema.org/> .
@prefix ex: <http://example.org/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfc: <https://w3id.org/rdf-connect#> .

#################################################################
# Logical Sources
#################################################################

# Root-level record
<#RootSource>
  rml:source [
    a rdfc:Source;
    rdfc:reader ex:source1;
  ];
  rml:referenceFormulation ql:JSONPath ;
  rml:iterator "$" .

<#WeatherReportMapping>
    a rr:TriplesMap ;
    rml:logicalSource <#RootSource> ;

    rr:subjectMap [
        rr:template "http://example.org/weatherForecast{$.reportDatetime}" ;
        rr:class schema:Report ;
    ] ;

    # headline
    rr:predicateObjectMap [
        rr:predicate schema:headline ;
        rr:objectMap [ rml:reference "$.headlineText" ; rr:language "ja" ] ;
    ] ;

    # dateCreated
    rr:predicateObjectMap [
        rr:predicate schema:dateCreated ;
        rr:objectMap [
            rml:reference "$.reportDatetime" ;
            rr:datatype xsd:dateTime ;
        ] ;
    ] ;

    # publisher (blank node)
    rr:predicateObjectMap [
        rr:predicate schema:publisher ;
        rr:objectMap [
            rr:parentTriplesMap <#PublisherMapping> ;
        ] ;
    ] ;

    # text
    rr:predicateObjectMap [
        rr:predicate schema:text ;
        rr:objectMap [ rml:reference "$.text" ; rr:language "ja" ] ;
    ] ;

    # spatialCoverage (blank node)
    rr:predicateObjectMap [
        rr:predicate schema:spatialCoverage ;
        rr:objectMap [
            rr:parentTriplesMap <#SpatialMapping> ;
        ] ;
    ] .

<#PublisherMapping>
    a rr:TriplesMap ;
    rml:logicalSource <#RootSource> ;

    rr:subjectMap [
        rr:template "http://example.org/weatherForecast{$.reportDatetime}#publisher" ;
        rr:class schema:Organization ;
    ] ;

    rr:predicateObjectMap [
        rr:predicate schema:name ;
        rr:objectMap [ rml:reference "$.publishingOffice" ; rr:language "ja" ] ;
    ] .

<#SpatialMapping>
    a rr:TriplesMap ;
    rml:logicalSource <#RootSource> ;

    rr:subjectMap [
        rr:template "http://example.org/weatherForecast{$.reportDatetime}#spatialCoverage" ;
        rr:class schema:Place ;
    ] ;

    rr:predicateObjectMap [
        rr:predicate schema:name ;
        rr:objectMap [ rml:reference "$.targetArea" ; rr:language "ja" ] ;
    ] .
